-- Вместо одной таблицы для сущности "Подписка" 
-- решил создать две таблицы — "отношения подписчиков к пользователям"
-- и "отношения подписчиков к сообществам". Таким образом не должна возникнуть проблема
-- с подпиской определенного пользователя на пользователя и сообщество с одинаковым значением id.
-- При этом проверка уникальности комбинации подписчик-пользователь / подписчик-сообщество
-- все еще присутствует (чтобы избежать множественной подписки 
-- пользователя на пользователя / сообщество). Также добавил дополнительную проверку
-- для таблицы "отношения подписчиков к пользователям", которая не позволяет пользователю
-- подписываться на самого себя.

CREATE TABLE followers_users (
	follower_user_id INT NOT NULL,
	user_id INT NOT NULL CHECK (follower_user_id != user_id),
	created_at TIMESTAMP,
	PRIMARY KEY (follower_user_id, user_id)
);

CREATE TABLE followers_communities (
	follower_user_id INT NOT NULL,
	community_id INT NOT NULL,
	created_at TIMESTAMP,
	PRIMARY KEY (follower_user_id, community_id)
);
